#  README.md

This folder contains the main scripts for the analysis.

These functions require your preprocessed fMRI time series to be saved in a matlab structure with a set of specific fields. An example of the structure can be generated by running the script *create_data_example.m* in the parent folder.

**Important Notes:**                                                       
use the script *create_data_example.m* to generate an example dataset that contains random generated time series for two subjects. The aim of this dataset is ONLY to show the formal structure required for input data. This dataset DO NOT simulate real fMRI time series. (Data are randomly generated without any assumptions) 

## Contents and description:

1. *dimensionality_reduction.m*: function to apply a dimensionality reduction from 343 ROIs to 90 ROIs. In the *data/* folder, the spatial coordinates of the priginal 343 ROIs (*Coord_343.m*) aand the original network information (*NET_343.mat*) are provided.
    - *Example: NET_reduction = dimensionality_reduction(Coord_343, NET_info_343, 19);*
2. *bold_orig2reduced.m*: function to project the original BOLD time series (343 ROIs) into the reduced space
3. *eval_LEs_DFC.m*: function to implement the sliding windows analysis and the definition of the Leading Eigenvectors and the DFC matrices
4. *main_DFS.m*: function to define the Dynamical Functional States (DFSs)
5. *static_severity_evaluation.m*: function to evaluate the static functional connectivity (FC) impairment severity used to split patients in severe and mild
6. *DFSs_dynamics.m*: function to evaluate the dynamics (i.e., fraction times, dwell times, Transition probabilities) of the DFSs in all groups.
7. *dynamic_measures_PCA.m*: function to apply a Principal Components Analysis on dynamical measures to derive the Dyn-PCs.
8. *RR_lesion_disconnection_vs_Dyn_PCs.m*: function to performe a ridge regression to explain the Dyn-PCs of sub-acute patients using the structural lesions or teh structural disconnection matrices as regressors.
9. *behavior_relationship.m*: function to analysze the contribution of the static component (ST) and the Dyn-PCs to explain behavioral deficits of sub-acute patients and behavioral recovery.

Additional functions:
* *DFCs_modularity.m*: function to evaluate network modularity of the DFC of each sliding window.
* *DFCs_homotopic_DAN_DMN_modularity,m*: function to evaluate the homotopic network connectivity, the DAN-DMN intra-hemispheric connectivity and the average network modularity of the DFC of each sliding window.

Subfolders:
* *stat_tests/*: it contains function to run statistical tests to compare dynamical measures between groups
* *utility/*: it contains utility functions
* *externals/*: it contains external toolboxes
* *data/*: it contains .mat files with spatial coordinates and network information
